image:
  tag: $ARGOCD_APP_REVISION

fullnameOverride: product-traceability-foss-backend-test

springprofile: dev

ingress:
  enabled: true
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/backend-protocol: HTTP
  hosts:
    - host: "traceability-test.dev.demo.catena-x.net"
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls:
    - hosts:
      - "traceability-test.dev.demo.catena-x.net"
      secretName: tls-secret

mailserver:
  host: "smtp.office365.com"
  port: "587"
  username: "notifications@catena-x.net"
  password: <path:traceability-foss/data/dev#mailserverPassword>

datasource:
  url: jdbc:postgresql://tracex-test-backend-postgresql-hl:5432/trace
  username: trace
  password: <path:traceability-foss/data/dev/database#tracePassword>

oauth2:
  clientId: <path:traceability-foss/data/dev/keycloak/oauth2#clientId>
  clientSecret: <path:traceability-foss/data/dev/keycloak/oauth2#clientSecret>
  clientTokenUri: "https://centralidp.dev.demo.catena-x.net/auth/realms/CX-Central/protocol/openid-connect/token"
  jwkSetUri: "https://centralidp.dev.demo.catena-x.net/auth/realms/CX-Central/protocol/openid-connect/certs"
  resourceClient: "Cl10-CX-Part"

postgresql:
  enabled: true
  fullnameOverride: "tracex-test-backend-postgresql"
  auth:
    postgresPassword: "<path:traceability-foss/data/dev/database#postgresPassword>"
    password: "<path:traceability-foss/data/dev/database#tracePassword>"
    database: "trace"
    username: "trace"

pgadmin4:
  enabled: true
  strategy:
    type: Recreate
  networkPolicy:
    enabled: false
  ingress:
    enabled: true
    annotations:
      kubernetes.io/ingress.class: nginx
      nginx.ingress.kubernetes.io/backend-protocol: HTTP
    hosts:
      - host: tracex-test-pgadmin4.dev.demo.catena-x.net
        paths:
          - path: /
            pathType: Prefix
    tls:
      - hosts:
          - tracex-test-pgadmin4.dev.demo.catena-x.net
        secretName: tls-secret
  env:
    email: pgadmin4@trace.foss
    password: "<path:traceability-foss/data/dev/database#pgadminPassword>"
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi

# for IRS, but needs to be on the base level
global:
  enablePrometheus: false
  enableGrafana: false

irs-helm:
  enabled: true

  nameOverride: "tracex-test-irs"
  fullnameOverride: "tracex-test-irs"

  namespace: product-traceability-foss

  irsUrl: "https://tracex-test-irs.dev.demo.catena-x.net"
  ingress:
    className: "nginx"
    annotations:
      nginx.ingress.kubernetes.io/backend-protocol: HTTP
    hosts:
      - host: "tracex-test-irs.dev.demo.catena-x.net"
        paths:
          - path: /
            pathType: ImplementationSpecific
    tls:
      - hosts:
          - "tracex-test-irs.dev.demo.catena-x.net"
        secretName: tls-secret

  digitalTwinRegistry:
    url: https://tracex-aas-registry.dev.demo.catena-x.net
  semanticsHub:
    url: https://semantics.dev.demo.catena-x.net/hub/api/v1
  bpdm:
    url: https://partners-pool.dev.demo.catena-x.net
  minioUser: <path:traceability-foss/data/dev/minio#user>
  minioPassword: <path:traceability-foss/data/dev/minio#password>
  keycloak:
    oauth2:
      clientId: <path:traceability-foss/data/dev/keycloak/oauth2#clientId>
      clientSecret: <path:traceability-foss/data/dev/keycloak/oauth2#clientSecret>
      clientTokenUri: https://centralidp.dev.demo.catena-x.net/auth/realms/CX-Central/protocol/openid-connect/token
      jwkSetUri: https://centralidp.dev.demo.catena-x.net/auth/realms/CX-Central/protocol/openid-connect/certs

  aasWrapper:
    username: tracefoss
    password: <path:traceability-foss/data/dev/edc/api-wrapper#wrapper.auth.basic.tracefoss>

  irs-minio:
    minioUser: <path:traceability-foss/data/dev/minio#user>
    minioPassword: <path:traceability-foss/data/dev/minio#password>

  irs-aaswrapper:
    edc:
      api:
        auth:
          key: <path:traceability-foss/data/dev/edc/controlplane#edc.api.control.auth.apikey.value>

  postgresql:
    auth:
      postgresPassword: <path:traceability-foss/data/dev/edc/database#password>
      password: <path:traceability-foss/data/dev/edc/database#password>

  # Values for consumer edc-controlplane.
  edc-controlplane:
    ingresses:
      - enabled: true
        hostname: "tracex-test-consumer-controlplane.dev.demo.catena-x.net"
        annotations:
          nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
        endpoints:
          - ids
          - data
        className: "nginx"
        tls:
          - hosts:
              - "tracex-test-consumer-controlplane.dev.demo.catena-x.net"
            secretName: tls-secret

    resources:
      limits:
        cpu: 2
        memory: 4Gi
      requests:
        cpu: 500m
        memory: 2Gi

    logging:
      # -- EDC logging.properties configuring the [java.util.logging subsystem](https://docs.oracle.com/javase/7/docs/technotes/guides/logging/overview.html#a1.8)
      properties: |-
        .level=INFO
        org.eclipse.dataspaceconnector.level=INFO
        net.catenax.edc.hashicorpvault.level=INFO
        handlers=java.util.logging.ConsoleHandler
        java.util.logging.ConsoleHandler.formatter=java.util.logging.SimpleFormatter
        java.util.logging.ConsoleHandler.level=INFO
        java.util.logging.SimpleFormatter.format=[%1$tY-%1$tm-%1$td %1$tH:%1$tM:%1$tS] [%4$-7s] %5$s%6$s%n

    edc:
      postgresql:
        password: <path:traceability-foss/data/dev/edc/database#password>
      transfer:
        proxy:
          token:
            verifier:
              publickey:
                alias: token-signer-cert-dev
            signer:
              privatekey:
                alias: token-signer-cert-key-dev
      api:
        auth:
          key: <path:traceability-foss/data/dev/edc/controlplane#edc.api.control.auth.apikey.value>
      controlplane:
        url: "tracex-consumer-controlplane.dev.demo.catena-x.net"
      dataplane:
        url: "tracex-consumer-dataplane.dev.demo.catena-x.net"
    configuration:
      properties: |-
        edc.oauth.client.id=3A:F4:B9:17:B7:01:BC:4D:A7:8B:58:19:18:30:7F:65:30:BB:90:62:keyid:3A:F4:B9:17:B7:01:BC:4D:A7:8B:58:19:18:30:7F:65:30:BB:90:62
        edc.oauth.public.key.alias=daps-cert-edc-test-provider-dev
        edc.oauth.private.key.alias=daps-cert-key-edc-test-provider-dev
        edc.oauth.provider.audience=idsc:IDS_CONNECTORS_ALL
        edc.oauth.provider.jwks.url=https://daps1.int.demo.catena-x.net/.well-known/jwks.json
        edc.oauth.token.url=https://daps1.int.demo.catena-x.net/token
        edc.vault.hashicorp.url=https://vault.demo.catena-x.net
        edc.vault.hashicorp.token=<path:traceability-foss/data/dev/edc#edc.vault.hashicorp.token>
        edc.vault.hashicorp.api.secret.path=/v1/traceability-foss
        edc.data.encryption.keys.alias=edc-data-encryption-keys-alias
        edc.data.encryption.algorithm=AES

  # Values for consumer edc-dataplane.
  edc-dataplane:
    edc:
      api:
        auth:
          key: <path:traceability-foss/data/dev/edc/controlplane#edc.api.control.auth.apikey.value>

    ingresses:
      - enabled: true
        hostname: "tracex-test-consumer-dataplane.dev.demo.catena-x.net"
        annotations:
          nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
        endpoints:
          - public
        className: "nginx"
        tls:
          - hosts:
              - "tracex-test-consumer-dataplane.dev.demo.catena-x.net"
            secretName: tls-secret

    resources:
      limits:
        cpu: 1
        memory: 1Gi
      requests:
        cpu: 500m
        memory: 512Mi

    logging:
      # -- EDC logging.properties configuring the [java.util.logging subsystem](https://docs.oracle.com/javase/7/docs/technotes/guides/logging/overview.html#a1.8)
      properties: |-
        .level=INFO
        org.eclipse.dataspaceconnector.level=INFO
        net.catenax.edc.hashicorpvault.level=INFO
        handlers=java.util.logging.ConsoleHandler
        java.util.logging.ConsoleHandler.formatter=java.util.logging.SimpleFormatter
        java.util.logging.ConsoleHandler.level=INFO
        java.util.logging.SimpleFormatter.format=[%1$tY-%1$tm-%1$td %1$tH:%1$tM:%1$tS] [%4$-7s] %5$s%6$s%n

    configuration:
      properties: |-
        edc.oauth.client.id=3A:F4:B9:17:B7:01:BC:4D:A7:8B:58:19:18:30:7F:65:30:BB:90:62:keyid:3A:F4:B9:17:B7:01:BC:4D:A7:8B:58:19:18:30:7F:65:30:BB:90:62
        edc.oauth.public.key.alias=daps-cert-edc-test-provider-dev
        edc.oauth.private.key.alias=daps-cert-key-edc-test-provider-dev
        edc.oauth.provider.audience=idsc:IDS_CONNECTORS_ALL
        edc.oauth.provider.jwks.url=https://daps1.int.demo.catena-x.net/.well-known/jwks.json
        edc.oauth.token.url=https://daps1.int.demo.catena-x.net/token
        edc.vault.hashicorp.url=https://vault.demo.catena-x.net
        edc.vault.hashicorp.token=<path:traceability-foss/data/dev/edc#edc.vault.hashicorp.token>
        edc.vault.hashicorp.api.secret.path=/v1/traceability-foss
